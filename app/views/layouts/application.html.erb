<!DOCTYPE html>
<html>
<head>
  <title>SiteResume</title>
  <%= stylesheet_link_tag    'application', media: 'all', 'data-turbolinks-track' => true %>
  <%= javascript_include_tag 'application', 'data-turbolinks-track' => true %>
  <%= csrf_meta_tags %>

  <script src="//js.pusher.com/2.2/pusher.min.js"></script>
  <script>
      // Enable pusher logging - don't include this in production
      Pusher.log = function(message) {
          if (window.console && window.console.log) {
             /*window.console.log(message);*/
          }
      };

      var pusher = new Pusher('bf3efe4f2a538719f902');
      var channel = pusher.subscribe('test_channel');
      var object_counter = {};
      channel.bind('my_event', function(data) {
          var object = data.message;

          for (var global_key in object_counter) {
              for( var object_key in object ) {
                  if(global_key==object_key) {
                      object_counter[global_key] += object[object_key];
                      delete object[object_key];
                  }
              }
          }

          _.extend(object_counter, object);

          var keysSorted = Object.keys(object_counter).sort(function(a,b){return object_counter[a]-object_counter[b]});
          window.console.log(object_counter);
          /*var key = Object.keys(data.message).map(function(key){return key});
          var value = Object.keys(data.message).map(function(key){return data.message[key]});

          $("#progress").prepend(object + "<br>");*/
      });
  </script>

</head>
<body>

<%= yield %>

</body>
</html>
